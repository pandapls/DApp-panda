<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>é’±åŒ…é“¾æ¥çš„åŸºç¡€demo</title>
  </head>
  <body>
    <input type="button" id="wallet" value="é“¾æ¥é’±åŒ…" />
    <script type="text/javascript" src="./node_modules/jquery/dist/jquery.min.js"></script>
    <script type="text/javascript" src="./node_modules/ethers/dist/ethers.umd.js"></script>
    <script type="text/javascript">
      //è·å–provider window.ethereumå°±æ˜¯metamaskå…¨å±€å˜é‡
      const provider = new ethers.providers.Web3Provider(window.ethereum);
      let signer = '';
      $(document).on('click', '#wallet', async () => {
        //å¼¹èµ·é’±åŒ…
        // è¿™ä¸ªè¯­æ³•ä¸ä¼šå¼ºè¡Œçš„å¼¹èµ·é’±åŒ… ç”¨æˆ·ä¸»åŠ¨çš„æ–­å¼€äº†è¿™ä¸ªé“¾æ¥çš„è¯ å¤±è´¥äº†~
        // const accounts = (await this.provider.request({ method: 'eth_accounts' })) as string[]
        await provider.send('eth_requestAccounts', []);
        //è·å¾—ç­¾å
        signer = provider.getSigner();
        const address = await signer.getAddress();
        console.log('address: ', address);
        let pendingBal = await provider.getBalance(address, 'pending');
        let balance = ethers.utils.formatEther(pendingBal);
        console.log('ğŸ‘›: ', balance);
      });
    </script>
  </body>
</html>
